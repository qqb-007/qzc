"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),_wepy=require("./../npm/wepy/lib/wepy.js"),_wepy2=_interopRequireDefault(_wepy),api=require("./../utils/api.js"),color=require("./../utils/color.js"),Index=function(e){function t(){var e,a,i,o;_classCallCheck(this,t);for(var n=arguments.length,r=Array(n),l=0;l<n;l++)r[l]=arguments[l];return a=i=_possibleConstructorReturn(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(r))),i.config={navigationBarTitleText:"菜助手",enablePullDownRefresh:!0,usingComponents:{"i-tabs":"../iview/tabs/index","i-tab":"../iview/tab/index"}},i.components={},i.data={bizData:{},dayType:"last1Days",startDate:"",endDate:"",maxDate:"",tabColor:color.success,dayBizData:{},wallet:{},obtainedMoney:0,showDetail:!1},i.methods={open:function(e){wx.navigateTo({url:e})},withdraw:function(){wx.navigateTo({url:"withdraw"})},dayChange:function(e){var t=e.detail;this.dayType=t.key,this.loadBizData(!0)},bindPickerChange:function(e){var t=e.detail;this[e.currentTarget.dataset.key]=t.value,this.loadBizData(!0)},toggleDetailShow:function(){this.showDetail=!this.showDetail}},i.events={},o=a,_possibleConstructorReturn(i,o)}return _inherits(t,e),_createClass(t,[{key:"loadData",value:function(){var e=this;return this.loadBizData(),api.page.index().done(function(t){var a=t.data;e.bizData=a.bizData,e.bizData.total=e.bizData.total.toFixed(1),e.bizData.meituanTotal=e.bizData.meituanTotal.toFixed(1),e.bizData.eleTotal=e.bizData.eleTotal.toFixed(1),e.startDate=a.startDate,e.endDate=a.endDate,e.maxDate=a.endDate,e.wallet=a.wallet;var i=e.wallet.money.toFixed(0).split(".");e.wallet.moneyInt=i[0],e.wallet.moneyDecimal=i[1],e.obtainedMoney=e.wallet.obtainedMoney.toFixed(1),e.$apply()})}},{key:"onPullDownRefresh",value:function(){this.loadData().done(function(){wx.stopPullDownRefresh()})}},{key:"loadBizData",value:function(e){var t=this;return e&&wx.showLoading(),api.stat.storeUserBizData({dayType:this.dayType,startTime:this.startDate,endTime:this.endDate}).done(function(a){t.dayBizData=a.data,t.dayBizData.perFee=t.dayBizData.perFee.toFixed(1),t.dayBizData.total=t.dayBizData.total.toFixed(1),t.dayBizData.meituanTotal=t.dayBizData.meituanTotal.toFixed(1),t.dayBizData.eleTotal=t.dayBizData.eleTotal.toFixed(1),t.dayBizData.elePerFee=t.dayBizData.elePerFee.toFixed(1),t.dayBizData.meituanPerFee=t.dayBizData.meituanPerFee.toFixed(1),t.$apply(),e&&wx.hideLoading()})}},{key:"onLoad",value:function(){wx.startPullDownRefresh()}}]),t}(_wepy2.default.page);Page(require("./../npm/wepy/lib/wepy.js").default.$createPage(Index,"pages/index"));